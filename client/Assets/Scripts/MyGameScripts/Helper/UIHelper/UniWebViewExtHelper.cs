using UnityEngine;


public static class UniWebViewExtHelper
{
	public static UniWebView CreateUniWebView(UIWidget widget, string url)
	{
		if (widget == null || !widget.isActiveAndEnabled)
		{
			return null;
		}

        // 强制刷新一遍
        widget.ResetAndUpdateAnchors();
		var camera = widget.anchorCamera;
		var bottomLeft = camera.WorldToScreenPoint(widget.worldCorners[0]);
		var topRight = camera.WorldToScreenPoint(widget.worldCorners[2]);

		return CreateUniWebView(widget.gameObject, url, Screen.height - topRight.y, bottomLeft.x, bottomLeft.y, Screen.width - topRight.x);
	}


	public static UniWebView CreateUniWebView(GameObject go, string url, float top, float left, float bottom, float right)
	{
		if (go == null || !go.activeSelf)
		{
			return null;
		}

		var view = go.GetComponent<UniWebView>();
		if (view == null)
		{
			view = go.AddComponent<UniWebView>();
		}

		view.insets = new UniWebViewEdgeInsets(UniWebViewHelper.ConvertPixelToPoint(top, false), UniWebViewHelper.ConvertPixelToPoint(left, true), UniWebViewHelper.ConvertPixelToPoint(bottom, false), UniWebViewHelper.ConvertPixelToPoint(right, true));
		view.SetShowSpinnerWhenLoading(false);
	    view.immersiveMode = false;
		view.url = url;

		return view;
	}
}
