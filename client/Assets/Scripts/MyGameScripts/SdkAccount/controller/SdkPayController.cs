// **********************************************************************
// Copyright (c) 2016 Baoyugame. All rights reserved.
// Author : Xianjian
// Created : 10/8/2016 2:29:23 PM
// Desc	: Auto generated by MarsZ. update this if need.
// **********************************************************************

using UnityEngine;
using SdkAccountDto;

/// <summary>
/// This is the controller class for module SelectLogin, use this to control the ui or view , such as it's init , update or dispose.
/// @Xianjian in 10/8/2016 2:29:23 PM
/// </summary>
public class SdkPayController : MonoViewController<SdkPayView>
{
    private System.Action<int> _onCallback;
    protected override void InitView()
    {
        View.WechatPayLogin_UIButton.enabled = FrameworkUpgradeHelper.IsSupported(FrameworkUpgradeHelper.IOS_WX_PAY);
        View.AliPayLogin_UIButton.enabled = FrameworkUpgradeHelper.IsSupported(FrameworkUpgradeHelper.H5_ALI_PAY);
    }
    
    public void SetCallback(System.Action<int> onCallback)
    {
        _onCallback = onCallback;
    }
    
    protected override void RegisterEvent()
    {
        EventDelegate.Set(_view.BackBtn_UIButton.onClick, OnCloceView);
        EventDelegate.Set(_view.AliPayLogin_UIButton.onClick, OnAlipay);
        EventDelegate.Set(_view.WechatPayLogin_UIButton.onClick, OnWechatPay);
    }

    public void OnCloceView()
    {
        SdkProxyModule.CloseModuleNow(SdkPayView.NAME);
        if (_onCallback != null)
        {
            _onCallback(0);
        }
    }

    private void OnAlipay()
    {
        SdkProxyModule.CloseModuleNow(SdkPayView.NAME);
        PayManager.thirdPayIsAli = true;
        if (_onCallback != null)
        {
            _onCallback(1);
        }
    }

    private void OnWechatPay()
    {
        SdkProxyModule.CloseModuleNow(SdkPayView.NAME);
        PayManager.thirdPayIsAli = false;
        if (_onCallback != null)
        {
            _onCallback(2);
        }
    }
}
